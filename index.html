<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IQRA Academy of Michigan Student Data Insights</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Custom CSS for animations and scrollbar hiding */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }\
            to { opacity: 1; transform: translateY(0); }
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }

        /* Basic print styles - to attempt vertical stacking.
           More robust print styles might be needed for complex layouts. */
        @media print {
            /* Universal print reset for consistent box model */
            * {
                box-sizing: border-box !important;
                margin: 0 !important;
                padding: 0 !important;
            }

            html, body {
                width: 100%;
                min-height: 100vh; /* Ensure content flows */
                overflow: visible !important; /* Prevent hidden content */
                font-family: sans-serif; /* Ensure a readable font */
            }

            .container {
                max-width: 100% !important;
                padding: 0.5in !important; /* Add some print margin */
            }

            /* Header adjustments for print */
            header {
                margin-bottom: 0.5in !important;
            }
            h1 {
                font-size: 2.2em !important; /* Slightly smaller for print */
                margin-bottom: 0.2em !important;
            }
            p {
                font-size: 1.1em !important;
            }

            /* Force sections and their direct children to stack vertically */
            section.grid {
                display: block !important;
                width: 100% !important; /* Ensure section takes full print width */
                margin-bottom: 0.5in !important; /* Space between major sections */
            }
            section.grid > div {
                display: block !important;
                width: 100% !important;
                margin-bottom: 0.3in !important; /* Add space between stacked charts/cards */
                page-break-inside: avoid !important; /* Prevent breaking charts/cards across pages */
            }

            /* Ensure chart canvases and their containers adjust height */
            .h-80, .h-96 {
                height: auto !important;
                min-height: 200px !important; /* Ensure a minimum height for charts */
            }
            canvas {
                max-width: 100% !important; /* Ensure canvas fits within its container */
                height: auto !important;
                display: block !important; /* Ensure canvas behaves as a block element */
            }

            /* Adjust font sizes for print if necessary */
            h2 { font-size: 1.4em !important; margin-bottom: 0.2em !important; }

            /* Hide elements not needed for print */
            .no-print {
                display: none !important;
            }

            /* Ensure backgrounds and shadows print */
            body {
                -webkit-print-color-adjust: exact; /* Chrome, Safari */
                color-adjust: exact; /* Firefox */
            }
            .bg-white, .shadow-lg {
                background-color: #ffffff !important;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1) !important; /* Lighter shadow for print */
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-12 fade-in">
            <h1 class="text-5xl font-extrabold text-gray-900 mb-4">IQRA Academy of Michigan Student Data Insights</h1>
            <p class="text-xl text-gray-600">Visualizing key student demographics and academic performance metrics.</p>
            <div class="w-24 h-1 bg-indigo-500 mx-auto mt-4 rounded-full"></div>
        </header>

        <section class="bg-white p-4 rounded-xl shadow-lg mb-8 flex flex-col md:flex-row items-center justify-between space-y-2 md:space-y-0 md:space-x-4 fade-in no-print">
            <div class="text-sm text-gray-600">
                Your User ID: <span id="userIdDisplay" class="font-bold text-gray-800">Loading...</span>
            </div>
            <div id="appMessage" class="text-sm text-gray-600"></div>
            <div id="loadingIndicator" class="hidden">
                <i class="fas fa-spinner fa-spin text-indigo-600 text-xl"></i>
            </div>
        </section>

        <section id="uploadSection" class="bg-white p-6 rounded-xl shadow-lg mb-8 flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 fade-in no-print hidden">
            <label for="csvFileInput" class="block text-gray-700 font-semibold">Upload Student Data (CSV):</label>
            <input type="file" id="csvFileInput" accept=".csv" class="block w-full md:w-auto text-sm text-gray-500
                file:mr-4 file:py-2 file:px-4
                file:rounded-full file:border-0
                file:text-sm file:font-semibold
                file:bg-purple-50 file:text-purple-700
                hover:file:bg-purple-100"/>
            <button id="loadCsvButton" class="px-6 py-2 rounded-full bg-indigo-600 text-white font-semibold shadow-md hover:bg-indigo-700 transition-colors duration-300">
                Load Data
            </button>
        </section>

        <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12 fade-in">
            <div class="bg-white rounded-xl shadow-md p-6 transition-all duration-300 card-hover">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-indigo-100 text-indigo-600 mr-4">
                        <i class="fas fa-users text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500">Total Students</p>
                        <h3 id="totalStudents" class="text-2xl font-bold text-gray-800">0</h3>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-6 transition-all duration-300 card-hover">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-blue-100 text-blue-600 mr-4">
                        <i class="fas fa-male text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500">Male Students</p>
                        <h3 id="maleStudents" class="text-2xl font-bold text-gray-800">0</h3>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-6 transition-all duration-300 card-hover">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-pink-100 text-pink-600 mr-4">
                        <i class="fas fa-female text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500">Female Students</p>
                        <h3 id="femaleStudents" class="text-2xl font-bold text-gray-800">0</h3>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-6 transition-all duration-300 card-hover">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-green-100 text-green-600 mr-4">
                        <i class="fas fa-calendar-alt text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500">Weekend Program</p>
                        <h3 id="weekendProgram" class="text-2xl font-bold text-gray-800">0</h3>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-md p-6 transition-all duration-300 card-hover">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-red-100 text-red-600 mr-4">
                        <i class="fas fa-exclamation-triangle text-xl"></i>
                    </div>
                    <div>
                        <p class="text-gray-500">Irregular Students</p>
                        <h3 id="irregularStudents" class="text-2xl font-bold text-gray-800">0</h3>
                    </div>
                </div>
            </div>
        </section>

        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <div class="bg-white rounded-xl shadow-md p-6 fade-in">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-venus-mars text-indigo-500 mr-2"></i>
                    Gender Distribution
                </h2>
                <div class="h-64">
                    <canvas id="genderChart"></canvas>
                </div>
                <div class="mt-4 text-sm text-gray-600">
                    <p id="genderInsight">Loading insights...</p>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-md p-6 fade-in">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-building text-orange-500 mr-2"></i>
                    Department Distribution
                </h2>
                <div class="h-64">
                    <canvas id="departmentChart"></canvas>
                </div>
                <div class="mt-4 text-sm text-gray-600">
                    <p id="departmentInsight">Loading insights...</p>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-md p-6 fade-in">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-chart-bar text-teal-500 mr-2"></i>
                    Level Distribution by Gender
                </h2>
                <div class="h-64">
                    <canvas id="levelGenderChart"></canvas>
                </div>
                <div class="mt-4 text-sm text-gray-600">
                    <p id="levelGenderInsight">Loading insights...</p>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-md p-6 fade-in">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-user-times text-red-500 mr-2"></i>
                    Regular vs. Irregular Students
                </h2>
                <div class="h-64">
                    <canvas id="regularIrregularChart"></canvas>
                </div>
                <div class="mt-4 text-sm text-gray-600">
                    <p id="regularIrregularInsight">Loading insights...</p>
                </div>
            </div>
        </section>

        <section class="bg-white rounded-xl shadow-md p-6 mb-12 fade-in">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-user-friends text-red-500 mr-2"></i>
                Top Parents by Number of Children Enrolled
            </h2>
            <div id="topParentsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="bg-gray-50 rounded-lg p-4 text-center text-gray-500 col-span-full">No top parent data available.</div>
            </div>
            <div class="mt-4 text-sm text-gray-600">
                <p id="topParentsInsight">Loading insights...</p>
            </div>
        </section>

        <section class="bg-white rounded-xl shadow-md p-6 mb-12 fade-in">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-lightbulb text-yellow-500 mr-2"></i>
                Key Insights from the Data
            </h2>
            <div id="keyInsightsContainer" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-blue-50 rounded-lg p-4">
                    <h3 class="font-semibold text-blue-800 mb-2 flex items-center">
                        <i class="fas fa-balance-scale text-blue-500 mr-2"></i>
                        Gender Balance
                    </h3>
                    <p id="insightGender" class="text-sm text-gray-700">Loading insights...</p>
                </div>
                <div class="bg-green-50 rounded-lg p-4">
                    <h3 class="font-semibold text-green-800 mb-2 flex items-center">
                        <i class="fas fa-home text-green-500 mr-2"></i>
                        Program Overview
                    </h3>
                    <p id="insightProgram" class="text-sm text-gray-700">Loading insights...</p>
                </div>
                <div class="bg-purple-50 rounded-lg p-4">
                    <h3 class="font-semibold text-purple-800 mb-2 flex items-center">
                        <i class="fas fa-chart-line text-purple-500 mr-2"></i>
                        Enrollment Status
                    </h3>
                    <p id="insightEnrollment" class="text-sm text-gray-700">Loading insights...</p>
                </div>
                <div class="bg-orange-50 rounded-lg p-4">
                    <h3 class="font-semibold text-orange-800 mb-2 flex items-center">
                        <i class="fas fa-graduation-cap text-orange-500 mr-2"></i>
                        Level Distribution Insights
                    </h3>
                    <p id="insightLevel" class="text-sm text-gray-700">Loading insights...</p>
                </div>
            </div>
        </section>

        <footer class="text-center py-6 text-gray-500 text-sm">
            <p>&copy; 2023 IQRA Academy of Michigan. All rights reserved.</p>
            <p class="mt-1">Data last updated: <span id="lastUpdated">N/A</span></p>
        </footer>
    </div>

    <script type="module" src="dashboard.js"></script>
</body>
</html>
